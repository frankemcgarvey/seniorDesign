import sys
import wave
import numpy as np
import matplotlib.pyplot as plt
from numpy.fft import fft, ifft
import os.path
import scipy.signal as signal

counter = 0
data1 = []
data2 = []



with open(os.path.dirname(__file__) + '/../pcmFiles/pcmFile.bin', 'rb') as pcmfile:
    hw = pcmfile.read(2)
    while hw:
        if counter%2 == 0:
                 data1.append(int.from_bytes(hw, "little", signed = "True"))
        elif counter%2 == 1:
                 data2.append(int.from_bytes(hw, "little", signed = "True"))
        counter = 1 + counter
        hw = pcmfile.read(2)

pcmData1 = np.array(data1)
pcmData2 = np.array(data2)

fig , ax = plt.subplots(ncols = 2, nrows=2)

b = [0.0000000000, 0.0000045568, 0.0000079429, 0.0000089652, 0.0000065666, -0.0000000000, -0.0000110132, -0.0000261631, -0.0000444868, -0.0000643738, -0.0000836492, -0.0000997351, -0.0001098801, -0.0001114420, -0.0001021996, -0.0000806626, -0.0000463496, 0.0000000000, 0.0000563093, 0.0001191642, 0.0001839462, 0.0002450994, 0.0002965215, 0.0003320572, 0.0003460582, 0.0003339661, 0.0002928667, 0.0002219628, 0.0001229144, -0.0000000000, -0.0001399317, -0.0002877392, -0.0004324939, -0.0005621923, -0.0006646374, -0.0007284275, -0.0007439835, -0.0007045274, -0.0006069314, -0.0004523504, -0.0002465679, 0.0000000000, 0.0002726730, 0.0005532530, 0.0008211197, 0.0010546196, 0.0012326622, 0.0013364153, 0.0013509716, 0.0012668561, 0.0010812391, 0.0007987390, 0.0004317169, -0.0000000000, -0.0004699905, -0.0009466868, -0.0013953320, -0.0017803366, -0.0020678858, -0.0022286198, -0.0022401861, -0.0020894676, -0.0017742875, -0.0013044312, -0.0007018537, 0.0000000000, 0.0007577761, 0.0015206431, 0.0022334531, 0.0028404533, 0.0032893156, 0.0035352083, 0.0035446188, 0.0032986326, 0.0027953878, 0.0020514769, 0.0011021182, -0.0000000000, -0.0011872086, -0.0023805967, -0.0034948178, -0.0044436962, -0.0051462939, -0.0055330386, -0.0055514937, -0.0051713386, -0.0043881624, -0.0032257324, -0.0017364717, 0.0000000000, 0.0018802977, 0.0037825713, 0.0055734445, 0.0071162395, 0.0082800230, 0.0089489408, 0.0090312427, 0.0084673977, 0.0072367326, 0.0053620576, 0.0029118937, -0.0000000000, -0.0032179151, -0.0065502571, -0.0097781662, -0.0126663055, -0.0149752870, -0.0164750684, -0.0169585794, -0.0162547864, -0.0142404065, -0.0108495485, -0.0060806153, 0.0000000000, 0.0072577707, 0.0154935708, 0.0244507976, 0.0338258147, 0.0432811938, 0.0524611250, 0.0610082038, 0.0685806572, 0.0748691484, 0.0796121880, 0.0826093331, 0.0837314054, 0.0826093331, 0.0796121880, 0.0748691484, 0.0685806572, 0.0610082038, 0.0524611250, 0.0432811938, 0.0338258147, 0.0244507976, 0.0154935708, 0.0072577707, 0.0000000000, -0.0060806153, -0.0108495485, -0.0142404065, -0.0162547864, -0.0169585794, -0.0164750684, -0.0149752870, -0.0126663055, -0.0097781662, -0.0065502571, -0.0032179151, -0.0000000000, 0.0029118937, 0.0053620576, 0.0072367326, 0.0084673977, 0.0090312427, 0.0089489408, 0.0082800230, 0.0071162395, 0.0055734445, 0.0037825713, 0.0018802977, 0.0000000000, -0.0017364717, -0.0032257324, -0.0043881624, -0.0051713386, -0.0055514937, -0.0055330386, -0.0051462939, -0.0044436962, -0.0034948178, -0.0023805967, -0.0011872086, -0.0000000000, 0.0011021182, 0.0020514769, 0.0027953878, 0.0032986326, 0.0035446188, 0.0035352083, 0.0032893156, 0.0028404533, 0.0022334531, 0.0015206431, 0.0007577761, 0.0000000000, -0.0007018537, -0.0013044312, -0.0017742875, -0.0020894676, -0.0022401861, -0.0022286198, -0.0020678858, -0.0017803366, -0.0013953320, -0.0009466868, -0.0004699905, -0.0000000000, 0.0004317169, 0.0007987390, 0.0010812391, 0.0012668561, 0.0013509716, 0.0013364153, 0.0012326622, 0.0010546196, 0.0008211197, 0.0005532530, 0.0002726730, 0.0000000000, -0.0002465679, -0.0004523504, -0.0006069314, -0.0007045274, -0.0007439835, -0.0007284275, -0.0006646374, -0.0005621923, -0.0004324939, -0.0002877392, -0.0001399317, -0.0000000000, 0.0001229144, 0.0002219628, 0.0002928667, 0.0003339661, 0.0003460582, 0.0003320572, 0.0002965215, 0.0002450994, 0.0001839462, 0.0001191642, 0.0000563093, 0.0000000000, -0.0000463496, -0.0000806626, -0.0001021996, -0.0001114420, -0.0001098801, -0.0000997351, -0.0000836492, -0.0000643738, -0.0000444868, -0.0000261631, -0.0000110132, -0.0000000000, 0.0000065666, 0.0000089652, 0.0000079429, 0.0000045568, 0.0000000000]

sig_i = signal.lfilter(b ,1, pcmData1)
sig_j = signal.lfilter(b, 1, pcmData2)


ax[0][0].plot(pcmData1)
ax[0][1].plot(pcmData2)

ax[1][0].plot(sig_i)
ax[1][1].plot(sig_j)

plt.show()